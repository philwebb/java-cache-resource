resources:
  - name: git-repo
    type: git
    source: &repo-source
      uri: https://github.com/philwebb/spring-boot.git
      branch: maven-restruct
  - name: maven-repo-cache
    type: maven-cache-resource
    source:
      <<: *repo-source
      depth: 1
      folders:
        - source: "~/.m2"
          dest: "m2"
        - source: "~/.gradle"
          dest: "gradle"
      commands:
        - "./mvnw -Dfast -DskipTests install dependency:go-offline"
        - "./mvnw -f spring-boot-samples/pom.xml dependency:go-offline"
        - "echo foo > ~/.m2/test"
      cleanup:
        - "*-SNAPSHOT"
